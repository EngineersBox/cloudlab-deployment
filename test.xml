<rspec xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.geni.net/resources/rspec/3" xmlns:client="http://www.protogeni.net/resources/rspec/ext/client/1" xsi:schemaLocation="http://www.geni.net/resources/rspec/3 http://www.geni.net/resources/rspec/3/request.xsd" type="request">
  <node client_id="node0" exclusive="true">
    <sliver_type name="raw">
      <disk_image name="urn:publicid:IDN+utah.cloudlab.us+image+cassandramulti7-PG0:ubuntu22-docker-java"/>
    </sliver_type>
    <interface client_id="node0:eth0">
      <ip address="10.0.0.0" netmask="255.255.255.0" type="ipv4"/>
    </interface>
    <services>
      <install url="https://github.com/EngineersBox/cassandra-benchmarking/releases/download/cassandra-5.0.2/cassandra.tar.gz" install_path="/var/lib"/>
      <execute shell="bash" command="echo &quot;# DC and Rack specification of this node&#10;dc=dc-0&#10;rack=rack-0&#10;&quot; &gt; /var/lib/cluster/config/cassandra-rackdc.properties"/>
      <execute shell="bash" command="echo &quot;# Mappings of Node IP=DC:Rack&#10;# Default mapping for unknown nodes&#10;default=dc-0:rack-0&#10;&#10;10.0.0.0=dc-0:rack-0&quot; &gt; /var/lib/cluster/config/cassandra-topology.properties"/>
      <execute shell="bash" command="mkdir -p /var/lib/cluster"/>
      <execute shell="bash" command="echo &quot;# Node configuration properties&#10;APPLICATION_VARIANT=cassandra&#10;APPLICATION_VERSION=5.0.2&#10;&#10;EBPF_NET_INTAKE_HOST=10.0.0.1&#10;EBPF_NET_INTAKE_PORT=8000&#10;&#10;OTEL_EXPORTER_OTLP_ENDPOINT=http://10.0.0.1:4318&#10;OTEL_SERVICE_NAME=node0&#10;OTEL_RESOURCE_ATTRIBUTES=application=cassandra&#10;&#10;NODE_IP=10.0.0.0&#10;&#10;NODE_ALL_IPS=(&quot;10.0.0.0&quot;)&#10;SEED_NODE=false&#10;INVOKE_INIT=false&#10;DC_COUNT=1&#10;YCSB_RF=1&#10;OTEL_METRICS_EXPORTER=otlp&#10;OTEL_TRACES_EXPORTER=always_on&#10;OTEL_LOGS_EXPORTER=otlp&quot; &gt; /var/lib/node_env"/>
      <execute shell="bash" command="sed -i &quot;s/@@COLLECTOR_ADDRESS@@/10.0.0.1/g&quot; /var/lib/cluster/config/otel/otel-instance.config.yaml"/>
      <execute shell="bash" command="echo &quot;&lt;TODO&gt;&quot; | docker login ghcr.io -u EngineersBox --password-stdin"/>
      <execute shell="bash" command="ln -s //var/lib/cluster/units/bootstrap.service /etc/systemd/system/bootstrap.service &amp;&amp; systemctl start bootstrap.service"/>
    </services>
  </node>
  <node client_id="node1" exclusive="true">
    <sliver_type name="raw">
      <disk_image name="urn:publicid:IDN+utah.cloudlab.us+image+cassandramulti7-PG0:ubuntu22-docker-java"/>
    </sliver_type>
    <interface client_id="node1:eth0">
      <ip address="10.0.0.1" netmask="255.255.255.0" type="ipv4"/>
    </interface>
    <services>
      <install url="https://github.com/EngineersBox/cassandra-benchmarking/releases/download/otel_collector-3.2.0/otel_collector.tar.gz" install_path="/var/lib"/>
      <install url="https://github.com/brianfrankcooper/YCSB/releases/download/0.17.0/ycsb-0.17.0.tar.gz" install_path="/var/lib"/>
      <execute shell="bash" command="mkdir -p /var/lib/cluster"/>
      <execute shell="bash" command="echo &quot;# Node configuration properties&#10;APPLICATION_VARIANT=otel_collector&#10;APPLICATION_VERSION=3.2.0&#10;&#10;EBPF_NET_INTAKE_HOST=10.0.0.1&#10;EBPF_NET_INTAKE_PORT=8000&#10;&#10;OTEL_EXPORTER_OTLP_ENDPOINT=http://10.0.0.1:4318&#10;OTEL_SERVICE_NAME=node1&#10;OTEL_RESOURCE_ATTRIBUTES=application=otel_collector&#10;&#10;NODE_IP=10.0.0.1&#10;&#10;OTEL_METRICS_EXPORTER=otlp&#10;OTEL_TRACES_EXPORTER=always_on&#10;OTEL_LOGS_EXPORTER=otlp&quot; &gt; /var/lib/node_env"/>
      <execute shell="bash" command="sed -i &quot;s/@@COLLECTOR_ADDRESS@@/10.0.0.1/g&quot; /var/lib/cluster/config/otel/otel-instance.config.yaml"/>
      <execute shell="bash" command="echo &quot;&lt;TODO&gt;&quot; | docker login ghcr.io -u EngineersBox --password-stdin"/>
      <execute shell="bash" command="ln -s //var/lib/cluster/units/bootstrap.service /etc/systemd/system/bootstrap.service &amp;&amp; systemctl start bootstrap.service"/>
      <execute shell="bash" command="cat &lt;&lt;-EOF /var/lib/cluster/ycsb-0.17.0/base_profile.dat&#10;        &#10;            hosts=10.0.0.0&#10;            port=9042&#10;            &#10;        EOF&#10;        "/>
    </services>
  </node>
  <link client_id="LAN">
    <interface_ref client_id="node0:eth0"/>
    <interface_ref client_id="node1:eth0"/>
    <link_type name="lan"/>
  </link>
</rspec>
